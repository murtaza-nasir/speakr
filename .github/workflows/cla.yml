name: "CLA Reminder"
on:
  pull_request_target:
    types: [opened]

permissions:
  pull-requests: write

jobs:
  cla-reminder:
    if: github.event_name == 'pull_request_target'
    runs-on: ubuntu-latest
    steps:
      - name: "Post CLA Reminder"
        uses: actions/github-script@v7
        with:
          script: |
            const prNumber = context.payload.pull_request?.number;
            if (!prNumber) {
              console.log('No PR number found, skipping');
              return;
            }
            const body = `Thank you for your contribution!

            By submitting this pull request, you agree to the terms of our [Contributor License Agreement (CLA)](https://github.com/${context.repo.owner}/${context.repo.repo}/blob/master/CLA.md).

            **Key points:**
            - You retain copyright ownership of your contribution
            - You grant us permission to use your contribution under our dual-license model (AGPLv3 and Commercial)
            - This allows us to include your contribution in both the open source and commercial versions of Speakr

            If you have any questions about the CLA, please let us know!`.replace(/^ {12}/gm, '');

            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: prNumber,
              body: body
            });
